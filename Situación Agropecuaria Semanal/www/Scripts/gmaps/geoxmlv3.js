String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),geoXML3=window.geoXML3||{instances:[]},geoXML3.parser=function(a){function k(a,b,c){return c=c||function(a){z(a,b)},"function"==typeof ZipFile&&"object"==typeof JSIO&&"function"==typeof JSIO.guessFileType&&(contentType=JSIO.guessFileType(b.baseUrl),contentType==JSIO.FileType.Binary||contentType==JSIO.FileType.Unknown)?(b.isCompressed=!0,b.baseDir=b.baseUrl+"/",void geoXML3.fetchZIP(a,c,b.internals.parser)):(b.isCompressed=!1,b.baseDir=defileURL(b.baseUrl),void geoXML3.fetchXML(a,c))}function u(a){var b=q(t(a,"styleUrl")[0]);if(b&&b.indexOf("#")!=-1)var c=b.split("#");else var c=["",""];return c}function v(a,b,c,d){var g="{inline}"===b?w(n):f[b][c]=f[b][c]||w(n),h=t(a,"BalloonStyle");h&&h.length>0&&(g.balloon.bgColor=q(t(h[0],"bgColor")[0],g.balloon.bgColor),g.balloon.textColor=q(t(h[0],"textColor")[0],g.balloon.textColor),g.balloon.text=q(t(h[0],"text")[0],g.balloon.text),g.balloon.displayMode=q(t(h[0],"displayMode")[0],g.balloon.displayMode));var h=t(a,"IconStyle");if(h&&h.length>0){var i=g.icon;i.scale=parseFloat(q(t(h[0],"scale")[0],i.scale)),h=t(a,"Icon"),h&&h.length>0&&(i.href=q(t(h[0],"href")[0]),i.url=cleanURL(d,i.href),e[i.url]&&(i.url=e[i.url].dataUrl),i.dim={x:parseInt(q(s(h[0],p,"x")[0],i.dim.x)),y:parseInt(q(s(h[0],p,"y")[0],i.dim.y)),w:parseInt(q(s(h[0],p,"w")[0],i.dim.w)),h:parseInt(q(s(h[0],p,"h")[0],i.dim.h))},h=t(a,"hotSpot"),h&&h.length>0&&(i.hotSpot={x:h[0].getAttribute("x"),y:h[0].getAttribute("y"),xunits:h[0].getAttribute("xunits"),yunits:h[0].getAttribute("yunits")}),((i.dim.w<0||i.dim.h<0)&&("pixels"!=i.xunits||"fraction"==i.yunits)||1!=i.scale)&&(i.img=new Image,i.img.onload=function(){(i.dim.w<0||i.dim.h<0)&&(i.dim.w=this.width,i.dim.h=this.height)},i.img.src=i.url,i.img.width>0&&(i.dim.w=i.img.width,i.dim.h=i.img.height)))}return h=t(a,"LineStyle"),h&&h.length>0&&(g.line.color=q(t(h[0],"color")[0],g.line.color),g.line.colorMode=q(t(h[0],"colorMode")[0],g.line.colorMode),g.line.width=q(t(h[0],"width")[0],g.line.width)),h=t(a,"PolyStyle"),h&&h.length>0&&(g.poly.color=q(t(h[0],"color")[0],g.poly.color),g.poly.colorMode=q(t(h[0],"colorMode")[0],g.poly.colorMode),g.poly.outline=r(t(h[0],"outline")[0],g.poly.outline),g.poly.fill=r(t(h[0],"fill")[0],g.poly.fill)),g}function w(a){if(null==a||"object"!=typeof a)return a;if(a.cloneNode)return a.cloneNode(!0);var b=new a.constructor;for(var c in a)b[c]=w(a[c]);return b}function x(a,c,d,e){for(var g=t(a,"Pair"),h=new Object,i=0;i<g.length;i++){var j=q(t(g[i],"key")[0]),k=q(t(g[i],"Style")[0]),l=u(g[i]),m=l[0]?cleanURL(e,l[0]):c,o=l[1];k?h[j]=v(k,m,o):o&&f[m][o]&&(h[j]=w(f[m][o]))}h.normal?f[c][d]=w(h.normal):f[c][d]=w(n),h.highlight&&b.processStyles&&C(h.highlight),f[c][d].map=w(h)}function y(a,b){for(var c=t(a,b),d=[],e=0;e<c.length;e++){var f=t(c[e],"coordinates");if(!f){if(d.length>0)break;return[{coordinates:[]}]}for(var g=0;g<f.length;g++){var h=q(f[g]).trim();h=h.replace(/,\s+/g,",");for(var i=h.split(/\s+/g),j=i.length,k=[],l=0;l<j;l++)h=i[l].split(","),isNaN(h[0])||isNaN(h[1])||k.push({lat:parseFloat(h[1]),lng:parseFloat(h[0]),alt:parseFloat(h[2])});d.push({coordinates:k})}}return d}google.maps.MVCObject.call(this);var h,b=new geoXML3.parserOptions(a),c=[],d={},e={},f={};!b.infoWindow&&b.singleInfoWindow&&(b.infoWindow=new google.maps.InfoWindow);var i=function(a,c){var d={parser:this,docSet:c||[],remaining:1,parseOnly:!(b.afterParse||b.processStyles)};thisDoc=new Object,thisDoc.internals=d,d.docSet.push(thisDoc),z(geoXML3.xmlParse(a),thisDoc)},j=function(a,c){h||(h="geoXML3.instances["+(geoXML3.instances.push(this)-1)+"]"),"string"==typeof a&&(a=[a]);for(var f,e={parser:this,docSet:c||[],remaining:a.length,parseOnly:!(b.afterParse||b.processStyles)},i=0;i<a.length;i++){var j=cleanURL(defileURL(location.pathname),a[i]);d[j]?(f=d[j],f.reload=!0):(f=new Object,f.baseUrl=j,e.docSet.push(f)),f.url=a[i],f.internals=e,k(f.url,f)}},l=function(a){a||(a=c[0]);var b;if(a.markers)for(b=0;b<a.markers.length;b++)a.markers[b].infoWindow&&a.markers[b].infoWindow.close(),a.markers[b].setVisible(!1);if(a.ggroundoverlays)for(b=0;b<a.ggroundoverlays.length;b++)a.ggroundoverlays[b].setOpacity(0);if(a.gpolylines)for(b=0;b<a.gpolylines.length;b++)a.gpolylines[b].infoWindow&&a.gpolylines[b].infoWindow.close(),a.gpolylines[b].setMap(null);if(a.gpolygons)for(b=0;b<a.gpolygons.length;b++)a.gpolygons[b].infoWindow&&a.gpolygons[b].infoWindow.close(),a.gpolygons[b].setMap(null)},m=function(a){a||(a=c[0]);var d;if(a.markers)for(d=0;d<a.markers.length;d++)a.markers[d].setVisible(!0);if(a.ggroundoverlays)for(d=0;d<a.ggroundoverlays.length;d++)a.ggroundoverlays[d].setOpacity(a.ggroundoverlays[d].percentOpacity_);if(a.gpolylines)for(d=0;d<a.gpolylines.length;d++)a.gpolylines[d].setMap(b.map);if(a.gpolygons)for(d=0;d<a.gpolygons.length;d++)a.gpolygons[d].setMap(b.map)},n={balloon:{bgColor:"ffffffff",textColor:"ff000000",text:"<h3>$[name]</h3>\n<div>$[description]</div>\n<div>$[geDirections]</div>",displayMode:"default"},icon:{scale:1,dim:{x:0,y:0,w:-1,h:-1},hotSpot:{x:.5,y:.5,xunits:"fraction",yunits:"fraction"}},line:{color:"ffffffff",colorMode:"normal",width:1},poly:{color:"ffffffff",colorMode:"normal",fill:!0,outline:!0}},p="http://www.google.com/kml/ext/2.2",q=geoXML3.nodeValue,r=geoXML3.getBooleanValue,s=geoXML3.getElementsByTagNameNS,t=geoXML3.getElementsByTagName,z=function(a,g){if(!a)return geoXML3.log("Unable to retrieve "+g.url),b.failedParse&&b.failedParse(g),void(g.failed=!0);if(a.parseError&&0!=a.parseError.errorCode){var i=a.parseError,j="Parse error in line "+i.line+", col "+i.linePos+" (error code: "+i.errorCode+")\n\nError Reason: "+i.reason+"Error Line: "+i.srcText;return geoXML3.log("Unable to retrieve "+g.url+": "+j),b.failedParse&&b.failedParse(g),void(g.failed=!0)}if(a.documentElement&&"parsererror"==a.documentElement.nodeName)return geoXML3.log("Unable to retrieve "+g.url+": "+a.documentElement.childNodes[0].nodeValue),b.failedParse&&b.failedParse(g),void(g.failed=!0);if(!g)throw"geoXML3 internal error: render called with null document";var l;g.placemarks=[],g.groundoverlays=[],g.ggroundoverlays=[],g.networkLinks=[],g.gpolygons=[],g.gpolylines=[];for(var m=t(a,"styleUrl"),o=g.internals.docSet,l=0;l<m.length;l++){var A=q(m[l]).split("#")[0];if(A){var B=cleanURL(g.baseDir,A);if(B!==g.baseUrl&&!d[B]){var I,J=o.indexOfObjWithItem("baseUrl",B);if(J!=-1){if(I=o[J],I.failed)continue}else I=new Object,I.url=B,I.baseUrl=B,I.internals=g.internals,g.internals.docSet.push(I),g.internals.remaining++;return void k(B,I,function(b){z(b,I),z(a,g)})}}}g.styles=f[g.baseUrl]=f[g.baseUrl]||{};var K;for(m=t(a,"Style"),nodeCount=m.length,l=0;l<nodeCount;l++){thisNode=m[l];var K=thisNode.getAttribute("id");K&&v(thisNode,g.baseUrl,K,g.baseDir)}for(m=t(a,"StyleMap"),l=0;l<m.length;l++){thisNode=m[l];var K=thisNode.getAttribute("id");K&&x(thisNode,g.baseUrl,K,g.baseDir)}if(!b.processStyles&&b.createMarker||D(g),g.reload&&g.markers)for(l=0;l<g.markers.length;l++)g.markers[l].active=!1;var M,N,Q,R,S,Q,T,U,V=t(a,"Placemark");for(pm=0;pm<V.length;pm++){N=V[pm];var W=u(N);M={name:q(t(N,"name")[0]),description:q(t(N,"description")[0]),styleUrl:W.join("#"),styleBaseUrl:W[0]?cleanURL(g.baseDir,W[0]):g.baseUrl,styleID:W[1],visibility:r(t(N,"visibility")[0],!0),balloonVisibility:r(s(N,p,"balloonVisibility")[0],!b.suppressInfoWindows)},M.style=f[M.styleBaseUrl]&&f[M.styleBaseUrl][M.styleID]||w(n);var X=t(N,"Style");if(X&&X.length>0){var Y=v(N,"{inline}","{inline}");C(Y),Y&&(M.style=Y)}/^https?:\/\//.test(M.description)&&(M.description=['<a href="',M.description,'">',M.description,"</a>"].join("")),M.vars={display:{name:"Name",description:"Description",address:"Street Address",id:"ID",Snippet:"Snippet",geDirections:"Directions"},val:{name:M.name||"",description:M.description||"",address:q(t(N,"address")[0],""),id:N.getAttribute("id")||"",Snippet:q(t(N,"Snippet")[0],"")},directions:["f=d","source=GeoXML3"]};var Z=t(N,"ExtendedData");if(Z&&Z.length>0)for(var $=t(Z[0],"Data"),_=0;_<$.length;_++){var aa=$[_],ba=aa.getAttribute("name");if(ba){var ca=q(t(aa,"displayName")[0],ba),da=q(t(aa,"value")[0]);M.vars.val[ba]=da,M.vars.display[ba]=ca}}var ea=t(N,"coordinates"),fa=null;if(ea&&ea.length>0)for(var ga=0;ga<ea.length;ga++)if(ea[ga].parentNode&&ea[ga].parentNode.nodeName){var ha=ea[ga].parentNode;switch(fa=ha.nodeName){case"Point":M.Point=y(N,"Point")[0],M.latlng=new google.maps.LatLng(M.Point.coordinates[0].lat,M.Point.coordinates[0].lng),S=1;break;case"LinearRing":T=t(N,"Polygon"),M.Polygon||(M.Polygon=[{outerBoundaryIs:{coordinates:[]},innerBoundaryIs:[{coordinates:[]}]}]);for(var ia=0;ia<T.length;ia++)M.Polygon[ia]={outerBoundaryIs:{coordinates:[]},innerBoundaryIs:[{coordinates:[]}]},M.Polygon[ia].outerBoundaryIs=y(T[ia],"outerBoundaryIs"),M.Polygon[ia].innerBoundaryIs=y(T[ia],"innerBoundaryIs");U=M.Polygon[0].outerBoundaryIs;break;case"LineString":S=0,M.LineString=y(N,"LineString")}}if(b.pmParseFn&&b.pmParseFn(N,M),g.placemarks.push(M),M.Point){google.maps&&(g.bounds=g.bounds||new google.maps.LatLngBounds,g.bounds.extend(M.latlng));var ja=b.createMarker||E,ka=!1;if(!b.createMarker&&g&&(g.markers=g.markers||[],g.reload))for(var J=0;J<g.markers.length;J++)if(g.markers[J].getPosition().equals(M.latlng)){ka=g.markers[J].active=!0;break}if(!ka){var Q=ja(M,g);Q&&(Q.active=M.visibility)}}var R,la;g&&(M.Polygon&&(g.gpolygons=g.gpolygons||[]),M.LineString&&(g.gpolylines=g.gpolylines||[]));var ma=b.createPolygon||H,na=b.createLineString||G;M.Polygon&&(R=ma(M,g),R&&(R.active=M.visibility)),M.LineString&&(la=na(M,g),la&&(la.active=M.visibility)),google.maps&&(g.bounds=g.bounds||new google.maps.LatLngBounds,R&&g.bounds.union(R.bounds),la&&g.bounds.union(la.bounds))}if(g.reload&&g.markers)for(l=g.markers.length-1;l>=0;l--)g.markers[l].active||(g.markers[l].infoWindow&&g.markers[l].infoWindow.close(),g.markers[l].setMap(null),g.markers.splice(l,1));if(g.reload&&g.groundoverlays)for(l=0;l<g.groundoverlays.length;l++)g.groundoverlays[l].active=!1;g&&(g.groundoverlays=g.groundoverlays||[]);var oa,ra,sa=t(a,"GroundOverlay");for(l=0;l<sa.length;l++){N=sa[l];var ta=cleanURL(g.baseDir,q(t(N,"href")[0]));e[ta]&&(ta=e[ta].dataUrl),oa={name:q(t(N,"name")[0]),description:q(t(N,"description")[0]),icon:{href:ta},latLonBox:{north:parseFloat(q(t(N,"north")[0])),east:parseFloat(q(t(N,"east")[0])),south:parseFloat(q(t(N,"south")[0])),west:parseFloat(q(t(N,"west")[0]))}},google.maps&&(g.bounds=g.bounds||new google.maps.LatLngBounds,g.bounds.union(new google.maps.LatLngBounds(new google.maps.LatLng(oa.latLonBox.south,oa.latLonBox.west),new google.maps.LatLng(oa.latLonBox.north,oa.latLonBox.east))));var ua=t(N,"color");if(ua&&ua.length>0?oa.opacity=geoXML3.getOpacity(q(ua[0])):oa.opacity=1,g.groundoverlays.push(oa),b.createOverlay)b.createOverlay(oa,g);else{var ka=!1;if(g&&(g.groundoverlays=g.groundoverlays||[],g.reload)){overlayBounds=new google.maps.LatLngBounds(new google.maps.LatLng(oa.latLonBox.south,oa.latLonBox.west),new google.maps.LatLng(oa.latLonBox.north,oa.latLonBox.east));var va=g.groundoverlays;for(l=va.length;l--;)if(va[l].bounds().equals(overlayBounds)&&va.url_===oa.icon.href){ka=va[l].active=!0;break}}ka||(ra=F(oa,g),ra.active=!0)}if(g.reload&&g.groundoverlays&&g.groundoverlays.length){var va=g.groundoverlays;for(l=va.length;l--;)va[l].active||(va[l].remove(),va.splice(l,1));g.groundoverlays=va}}var wa,xa=document.location.pathname.split("/");xa=xa.splice(0,xa.length-1).join("/");var ya=t(a,"NetworkLink");for(l=0;l<ya.length;l++)N=ya[l],wa={name:q(t(N,"name")[0]),link:{href:q(t(N,"href")[0]),refreshMode:q(t(N,"refreshMode")[0])}},wa.link.refreshMode||(wa.link.refreshMode="onChange"),"onInterval"===wa.link.refreshMode?(wa.link.refreshInterval=parseFloat(q(t(N,"refreshInterval")[0])),isNaN(wa.link.refreshInterval)&&(wa.link.refreshInterval=0)):"onChange"===wa.link.refreshMode&&(wa.link.viewRefreshMode=q(t(N,"viewRefreshMode")[0]),wa.link.viewRefreshMode||(wa.link.viewRefreshMode="never"),"onStop"===wa.link.viewRefreshMode&&(wa.link.viewRefreshTime=q(t(N,"refreshMode")[0]),wa.link.viewFormat=q(t(N,"refreshMode")[0]),wa.link.viewFormat||(wa.link.viewFormat="BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]"))),/^[\/|http]/.test(wa.link.href)||(wa.link.href=xa+"/"+wa.link.href),"onInterval"===wa.link.refreshMode&&wa.link.refreshInterval>0?setInterval(h+'.parse("'+wa.link.href+'")',1e3*wa.link.refreshInterval):"onChange"===wa.link.refreshMode&&("never"===wa.link.viewRefreshMode?g.internals.parser.parse(wa.link.href,g.internals.docSet):"onStop"===wa.link.viewRefreshMode);if(g.bounds&&(g.internals.bounds=g.internals.bounds||new google.maps.LatLngBounds,g.internals.bounds.union(g.bounds)),(g.markers||g.groundoverlays||g.gpolylines||g.gpolygons)&&(g.internals.parseOnly=!1),!g.internals.parseOnly)if(d[g.baseUrl])for(var l in d[g.baseUrl])d[g.baseUrl][l]=g[l];else c.push(g),d[g.baseUrl]=g;g.internals.remaining--,0===g.internals.remaining&&(b.zoom&&g.internals.bounds&&!g.internals.bounds.isEmpty()&&b.map&&b.map.fitBounds(g.internals.bounds),b.afterParse&&b.afterParse(g.internals.docSet),google.maps.event.trigger(g.internals.parser,"parsed"))},A=function(a,b){var c={};a=a||"ffffffff";var d=a.substr(0,2),e=a.substr(2,2),f=a.substr(4,2),g=a.substr(6,2);return c.opacity=parseInt(d,16)/256,c.color="random"===b?B(g,f,e):"#"+g+f+e,c},B=function(a,b,c){var d={rr:a,gg:b,bb:c};for(var e in d){var f=d[e];null==f&&(f="ff"),f=Math.round(Math.random()*parseInt(a,16)).toString(16),1===f.length&&(f="0"+f),d[e]=f}return"#"+d.rr+d.gg+d.bb},C=function(a){var b=a.icon;if(b.href){if(b.img&&!b.img.complete&&b.dim.w<0&&b.dim.h<0)return b.markerBacklog=[],void(b.img.onload=function(){(b.dim.w<0||b.dim.h<0)&&(b.dim.w=this.width,b.dim.h=this.height),C(a);for(var c=0;c<b.markerBacklog.length;c++){var d=b.markerBacklog[c][0],e=b.markerBacklog[c][1];E(d,e),d.marker&&(d.marker.active=!0)}delete b.markerBacklog});(b.dim.w<0||b.dim.h<0)&&(b.img&&b.img.complete?(b.dim.w=b.img.width,b.dim.h=b.img.height):(b.dim.whGuess=!0,b.dim.w=32,b.dim.h=32));var f,g,c=Math.round,d={x:b.dim.x*b.scale,y:b.dim.y*b.scale,w:b.dim.w*b.scale,h:b.dim.h*b.scale,aX:b.hotSpot.x*b.scale,aY:b.hotSpot.y*b.scale,iW:(b.img?b.img.width:b.dim.w)*b.scale,iH:(b.img?b.img.height:b.dim.h)*b.scale};switch(b.hotSpot.xunits){case"fraction":f=c(d.aX*b.dim.w);break;case"insetPixels":f=c(b.dim.w*b.scale-d.aX);break;default:f=c(d.aX)}g=d.h-c(("fraction"===b.hotSpot.yunits?b.dim.h:1)*d.aY);var h=new google.maps.Point(f,g),i=b.dim.whGuess?null:new google.maps.Size(c(d.w),c(d.h)),j=1==b.scale?null:b.dim.whGuess?new google.maps.Size(c(d.w),c(d.h)):new google.maps.Size(c(d.iW),c(d.iH)),k=new google.maps.Point(c(d.x),c(d.y));e[b.url]&&(b.url=e[b.url].dataUrl),b.marker={url:b.url,size:i,origin:k,anchor:h,scaledSize:j};var l=/\/(red|blue|green|yellow|lightblue|purple|pink|orange)(-dot)?\.png/,m=new google.maps.Size(59,32),n=new google.maps.Point(16,32);l.test(b.href)?b.shadow={url:"http://maps.google.com/mapfiles/ms/micons/msmarker.shadow.png",size:m,origin:null,anchor:n,scaledSize:m}:b.href.indexOf("-pushpin.png")>-1&&(b.shadow={url:"http://maps.google.com/mapfiles/ms/micons/pushpin_shadow.png",size:m,origin:null,anchor:n,scaledSize:m})}},D=function(a){for(var b in a.styles)C(a.styles[b])},E=function(a,c){var d=a.style.icon;if(!d.marker&&d.img)return d.markerBacklog=d.markerBacklog||[],void d.markerBacklog.push([a,c]);var e=geoXML3.combineOptions(b.markerOptions,{map:b.map,position:new google.maps.LatLng(a.Point.coordinates[0].lat,a.Point.coordinates[0].lng),title:a.name,zIndex:Math.round(a.Point.coordinates[0].lat*-1e5)<<5,icon:d.marker,shadow:d.shadow,flat:!d.shadow,visible:a.visibility}),f=new google.maps.Marker(e);return c&&c.markers.push(f),I(a,c,f),a.marker=f,f},F=function(a,c){if(!window.ProjectedOverlay)throw"geoXML3 error: ProjectedOverlay not found while rendering GroundOverlay from KML";var d=new google.maps.LatLngBounds(new google.maps.LatLng(a.latLonBox.south,a.latLonBox.west),new google.maps.LatLng(a.latLonBox.north,a.latLonBox.east)),e=geoXML3.combineOptions(b.overlayOptions,{percentOpacity:100*a.opacity}),f=new ProjectedOverlay(b.map,a.icon.href,d,e);return c&&(c.ggroundoverlays=c.ggroundoverlays||[],c.ggroundoverlays.push(f)),f},G=function(a,c){for(var d=[],e=new google.maps.LatLngBounds,f=0;f<a.LineString.length;f++)for(var g=a.LineString[f].coordinates,h=0;h<g.length;h++){var i=new google.maps.LatLng(g[h].lat,g[h].lng);d.push(i),e.extend(i)}var k=(d[Math.floor(d.length/2)],A(a.style.line.color,a.style.line.colorMode)),l=geoXML3.combineOptions(b.polylineOptions,{map:b.map,path:d,strokeColor:k.color,strokeWeight:a.style.line.width,strokeOpacity:k.opacity,title:a.name,visible:a.visibility}),m=new google.maps.Polyline(l);return m.bounds=e,I(a,c,m),c&&c.gpolylines.push(m),a.polyline=m,m},H=function(a,c){for(var d=new google.maps.LatLngBounds,e=0,f=[],g=0;g<a.Polygon.length;g++){for(var h=0;h<a.Polygon[g].outerBoundaryIs.length;h++){for(var i=a.Polygon[g].outerBoundaryIs[h].coordinates,j=[],k=0;k<i.length;k++){var l=new google.maps.LatLng(i[k].lat,i[k].lng);j.push(l),d.extend(l)}f.push(j),e+=j.length}for(var h=0;h<a.Polygon[g].innerBoundaryIs.length;h++){for(var i=a.Polygon[g].innerBoundaryIs[h].coordinates,j=[],k=0;k<i.length;k++){var l=new google.maps.LatLng(i[k].lat,i[k].lng);j.push(l),d.extend(l)}f.push(j),e+=j.length}}var m=A(a.style.line.color,a.style.line.colorMode),n=A(a.style.poly.color,a.style.poly.colorMode);a.style.poly.fill||(n.opacity=0);var o=a.style.line.width;a.style.poly.outline||(o=0,m.opacity=0);var p=geoXML3.combineOptions(b.polygonOptions,{map:b.map,paths:f,title:a.name,strokeColor:m.color,strokeWeight:o,strokeOpacity:m.opacity,fillColor:n.color,fillOpacity:n.opacity,visible:a.visibility}),q=new google.maps.Polygon(p);return q.bounds=d,I(a,c,q),c&&c.gpolygons.push(q),a.polygon=q,q},I=function(a,c,d){var f=a.style.balloon,g=a.vars;if(a.balloonVisibility&&"hide"!==f.displayMode){if(a.latlng){g.directions.push("sll="+a.latlng.toUrlValue());var h="http://maps.google.com/maps?"+g.directions.join("&"),i=encodeURIComponent(g.val.address||a.latlng.toUrlValue()).replace(/\%20/g,"+");g.val.geDirections='<a href="'+h+"&daddr="+i+'" target=_blank>To Here</a> - <a href="'+h+"&saddr="+i+'" target=_blank>From Here</a>'}else g.val.geDirections="";var j=f.text.replace(/\$\[(\w+(\/displayName)?)\]/g,function(a,b,c){return c?g.display[b]:g.val[b]}),k="geoxml3_infowindow geoxml3_style_"+a.styleID,l=[];"ffffffff"!=f.bgColor&&l.push("background: "+A(f.bgColor).color+";"),"ff000000"!=f.textColor&&l.push("color: "+A(f.textColor).color+";");var m=l.length?' style="'+l.join(" ")+'"':"",n=geoXML3.combineOptions(b.infoWindowOptions,{content:'<div class="'+k+'"'+m+">"+j+"</div>",pixelOffset:new google.maps.Size(0,2)});d.infoWindow=b.infoWindow||new google.maps.InfoWindow(n),d.infoWindowOptions=n,google.maps.event.addListener(d,"click",function(a){var b=this.infoWindow;b.close(),b.setOptions(this.infoWindowOptions),a&&a.latLng?b.setPosition(a.latLng):this.bounds&&b.setPosition(this.bounds.getCenter()),b.setContent("<div id='geoxml3_infowindow'>"+b.getContent()+"</div>"),google.maps.event.addListenerOnce(b,"domready",function(){for(var a=document.getElementById("geoxml3_infowindow"),b=a.getElementsByTagName("img"),d=0;d<b.length;d++){var f=b[d].getAttribute("src"),g=cleanURL(c.baseDir,f);e[g]?b[d].src=e[g].dataUrl:e[f]&&(b[d].src=e[f].dataUrl)}}),b.open(this.map,this.bounds?null:this)})}};return{options:b,docs:c,docsByUrl:d,kmzMetaData:e,parse:j,render:z,parseKmlString:i,hideDocument:l,showDocument:m,processStyles:D,createMarker:E,createOverlay:F,createPolyline:G,createPolygon:H}},geoXML3.getOpacity=function(a){if(a&&""!==a&&8==a.length){var b=parseInt(a.substr(0,2),16);return b/255}return 1},geoXML3.log=function(a){window.console?console.log(a):alert("log:"+a)},geoXML3.parserOptions=function(a){if(this.map=null,this.zoom=!0,this.singleInfoWindow=!1,this.suppressInfoWindows=!1,this.processStyles=!1,this.markerOptions={},this.infoWindowOptions={},this.overlayOptions={},this.afterParse=null,this.failedParse=null,this.createMarker=null,this.createOverlay=null,a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);return this},geoXML3.combineOptions=function(a,b){var c={};if(a)for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);if(b)for(d in b)b.hasOwnProperty(d)&&void 0===c[d]&&(c[d]=b[d]);return c},geoXML3.parserOptions.prototype.combineOptions=geoXML3.combineOptions,geoXML3.fetchers=[],geoXML3.xmlParse=function(a){if("undefined"!=typeof ActiveXObject&&"undefined"!=typeof GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");return b.loadXML(a),b}if("undefined"!=typeof DOMParser){var c=new DOMParser;return c.parseFromString(a,"text/xml")}return createElement("div",null)},geoXML3.fetchXML=function(a,b){function c(){b()}var d=new Object;if(geoXML3.fetchers.length)d=geoXML3.fetchers.pop();else if(window.XMLHttpRequest)d.fetcher=new window.XMLHttpRequest;else if(window.ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP","MSXML.XMLHTTP"],f=0;f<e.length;f++)try{d.fetcher=new ActiveXObject(e[f]);break}catch(a){continue}if(!d.fetcher)return geoXML3.log("Unable to create XHR object"),b(null),null}return d.fetcher.open("GET",a,!0),d.fetcher.overrideMimeType&&d.fetcher.overrideMimeType("text/xml"),d.fetcher.onreadystatechange=function(){if(4===d.fetcher.readyState){if(d.xhrtimeout&&clearTimeout(d.xhrtimeout),d.fetcher.status>=400)geoXML3.log("HTTP error "+d.fetcher.status+" retrieving "+a),b();else if(d.fetcher.responseXML){var c=d.fetcher.responseXML;!c||c.documentElement||c.ownerElement||c.loadXML(d.fetcher.responseText),b(c)}else b(geoXML3.xmlParse(d.fetcher.responseText));geoXML3.fetchers.push(d)}},d.xhrtimeout=setTimeout(c,6e4),d.fetcher.send(null),null};var IEversion=function(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return a};geoXML3.fetchZIP=function(a,b,c){new ZipFile(a,function(d){for(var e=0;e<d.status.length;e++){var f=d.status[e];if(0==f.indexOf("ERROR"))return geoXML3.log("HTTP/ZIP error retrieving "+a+": "+f),void b();0==f.indexOf("WARNING")&&geoXML3.log("HTTP/ZIP warning retrieving "+a+": "+f)}for(var h,g=0,e=0;e<d.entries.length;e++){var i=d.entries[e].name;/\.kml$/.test(i)&&(g++,1==g?h=e:geoXML3.log("KMZ warning retrieving "+a+': found extra KML "'+i+'" in KMZ; discarding...'))}for(var j=cleanURL(defileURL(a),a)+"/",k={timer:null,extractLeft:0,timerCalls:0},l=function(a,d){var e=cleanURL(j,a.name),f=a.name.substring(a.name.lastIndexOf(".")+1).toLowerCase();if(k.extractLeft--,"string"==typeof d.description&&"Error"==d.name)return geoXML3.log("KMZ error extracting "+e+": "+d.description),void b();var g;"jpg"===f&&(f="jpeg"),g=/^(gif|jpeg|png)$/.test(f)?"image/"+f:"mp3"===f?"audio/mpeg":"m4a"===f?"audio/mp4":"m4a"===f?"audio/MP4-LATM":"application/octet-stream",c.kmzMetaData[e]={},c.kmzMetaData[e].entry=a,c.kmzMetaData[e].dataUrl="data:"+g+";base64,"+base64Encode(d),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&(IEversion()<8&&c.kmzMetaData[e].dataUrl.length>2071||IEversion<9&&c.kmzMetaData[e].dataUrl.length>32767)&&(c.kmzMetaData[e].dataUrl="data:image/gif;base64,R0lGODlhDwAQAOMPADBPvSpQ1Dpoyz1p6FhwvU2A6ECP63CM04CWxYCk+V6x+UK++Jao3rvC3fj7+v///yH5BAEKAA8ALAAAAAAPABAAAASC8Mk5mwCAUMlWwcLRHEelLAoGDMgzSsiyGCAhCETDPMh5XQCBwYBrNBIKWmg0MCQHj8MJU5IoroYCY6AAAgrDIbbQDGIK6DR5UPhlNo0JAlSUNAiDgH7eNAxEDWAKCQM2AAFheVxYAA0AIkFOJ1gBcQQaUQKKA5w7LpcEBwkJaKMUEQA7"),c.kmzMetaData[internalSrc(a.name)]=c.kmzMetaData[e]},m=function(c,d){return"string"==typeof d.description&&"Error"==d.name?(geoXML3.log("KMZ error extracting "+mdUrl+": "+d.description),void b()):(clearTimeout(k.timer),k.extractLeft<=1?(k.extractLeft--,void b(geoXML3.xmlParse(d))):(k.timerCalls++,void(k.timerCalls<100?k.timer=setTimeout(function(){m(c,d)},100):(geoXML3.log("KMZ warning extracting "+a+": entire ZIP has not been extracted after 10 seconds; running through KML, anyway..."),k.extractLeft--,b(geoXML3.xmlParse(d))))))},e=0;e<d.entries.length;e++){var n=d.entries[e],o=n.name.substring(n.name.lastIndexOf(".")+1).toLowerCase();/^(gif|jpe?g|png|kml)$/.test(o)&&("kml"===o&&e!=h||(c||"kml"==o)&&(k.extractLeft++,"kml"===o?n.extract(m):n.extract(l)))}})},geoXML3.nodeValue=function(a,b){var c="";if(!a)return"undefined"==typeof b||null===b?null:b;if(3==a.nodeType||4==a.nodeType||2==a.nodeType)c+=a.nodeValue;else if(1==a.nodeType||9==a.nodeType||11==a.nodeType)for(var d=0;d<a.childNodes.length;++d)c+=arguments.callee(a.childNodes[d]);return c},geoXML3.getBooleanValue=function(a,b){var c=geoXML3.nodeValue(a);return null===c?b||!1:(c=parseInt(c),!!isNaN(c)||0!=c)},geoXML3.getElementsByTagNameNS=function(a,b,c){if(a&&"undefined"!=typeof a.getElementsByTagNameNS)return a.getElementsByTagNameNS(b,c);if(!a)return[];var d=a.documentElement||a.ownerDocument&&a.ownerDocument.documentElement;if(!d||!d.attributes)return[];for(var e=0;e<d.attributes.length;e++){var f=d.attributes[e];if("xmlns"===f.prefix&&f.nodeValue===b)return a.getElementsByTagName(f.baseName+":"+c);if("xmlns"===f.nodeName&&f.nodeValue===b)return"undefined"!=typeof a.selectNodes?(d.ownerDocument.getProperty("SelectionNamespaces")||d.ownerDocument.setProperty("SelectionNamespaces","xmlns:defaultNS='"+b+"'"),a.selectNodes(".//defaultNS:"+c)):(d.setAttribute("xmlns:defaultNS",b),a.getElementsByTagName("defaultNS:"+c))}return geoXML3.getElementsByTagName(a,c)},geoXML3.getElementsByTagName=function(a,b){return a&&"undefined"!=typeof a.getElementsByTagNameNS?a.getElementsByTagName(b):a.getElementsByTagName(b)};var toAbsURL=function(a,b){var c,d,e,f=location.protocol+"://"+location.host;if(!b.length)return"";if(/^\w+:/.test(b))return b;if(0==b.indexOf("/"))return f+b;if(c=a.replace(/\/[^\/]*$/,""),d=b.match(/\.\.\//g))for(b=b.substring(3*d.length),e=d.length;e--;)c=c.substring(0,c.lastIndexOf("/"));return f+c+"/"+b},internalSrc=function(a){var b=document.location.href;b=b.substring(0,b.lastIndexOf("/")+1);var c=b+a;return c},dehostURL=function(a){var b=location.protocol+"://"+location.host;return b=b.replace(/([\.\\\+\*\?\[\^\]\$\(\)])/g,"\\$1"),a.replace(new RegExp("^"+b,"i"),"")},cleanURL=function(a,b){return dehostURL(toAbsURL(a?a.split("#")[0].split("?")[0]:defileURL(location.pathname),b?b.split("#")[0].split("?")[0]:""))},defileURL=function(a){return a?a.substr(0,a.lastIndexOf("/")+1):"/"};Array.prototype.hasObject=Array.indexOf?function(a){return this.indexOf(a)!==-1}:function(a){for(var b=this.length+1;b--;)if(this[b-1]===a)return!0;return!1},Array.prototype.hasItemInObj=function(a,b){for(var c=this.length+1;c--;)if(this[c-1][a]===b)return!0;return!1},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){null==b?b=0:b<0&&(b=Math.max(0,this.length+b));for(var c=b,d=this.length;c<d;c++)if(this[c]===a)return c;return-1}),Array.prototype.indexOfObjWithItem=function(a,b,c){null==c?c=0:c<0&&(c=Math.max(0,this.length+c));for(var d=c,e=this.length;d<e;d++)if(this[d][a]===b)return d;return-1};var base64Encode=function(a){for(var d,e,f,g,h,i,j,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",k=0;k<a.length;)d=a[k++],e=a[k++],f=a[k++],g=d>>2,h=(3&d)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,void 0==e?i=j=64:void 0==f&&(j=64),c=c+b.charAt(g)+b.charAt(h)+b.charAt(i)+b.charAt(j);return c};